{% extends "_base.html" %}
{% load humanize %}

{% block content %}
    <div class="m-8">
        {% if todos.count == 0 %}
            <div class="prose">
                <h3 class="prose-h3">No to-dos found</h3>
            </div>
        {% else %}
            <div class="grid grid-cols-12 items-center bg-base-100 border-b border-base-content p-2 mb-2 text-base-content font-medium text-sm">
                <div class="col-span-7">Todo</div>
                <div class="text-center">Priority</div>
                <div class="col-span-2 text-center">Projects</div>
                <div class="text-center">Due Date</div>
                <div class="text-center">Actions</div>
            </div>

            <div class="flex flex-col divide-y">
                {% for todo in todos %}
                    <div class="grid grid-cols-12 items-center p-2 hover:bg-base-200 rounded rounded-md">
                        <div class="col-span-7 grid grid-cols-12 items-center gap-x-2">
                            <div>
                                {% if todo.is_completed %}
                                    <span class="material-symbols-rounded text-success">check</span>
                                {% elif todo.is_due_soon %}
                                    <span class="material-symbols-rounded text-warning">warning</span>
                                {% elif todo.is_overdue %}
                                    <span class="material-symbols-rounded text-error">emergency_home</span>
                                {% endif %}
                            </div>

                            <div class="col-span-11 flex flex-col gap-y-2">
                                <div class="flex font-semibold text-lg
                                    {% if not todo.is_completed %}
                                        {% if todo.is_due_soon %}
                                            text-warning
                                        {% elif todo.is_overdue %}
                                            text-error
                                        {% endif %}
                                    {% endif %}
                                ">
                                    {{ todo.description }}
                                </div>
                                <div class="flex flex-row gap-x-2">
                                    <div>
                                        <div class="badge badge-secondary">
                                            <span class="material-symbols-rounded mr-1 text-sm">not_started</span>
                                            {{ todo.start_date|naturalday:"D d b Y"|capfirst }}
                                        </div>
                                    </div>
                                    <div>
                                        {% if todo.contexts.all.count > 0 %}
                                            <div class="flex gap-x-1">
                                                {% for context in todo.contexts.all %}
                                                    <div class="badge badge-primary">
                                                        <span class="material-symbols-rounded mr-1 text-sm">alternate_email</span>    
                                                        {{ context.name }}
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="justify-self-center self-center">
                            {% if todo.priority is None or todo.priority == "" %}
                                -
                            {% else %}
                                {% if todo.priority == "A" %}
                                    <div class="badge badge-accent">high (A)</div>
                                {% elif todo.priority == "B" %}
                                    <div class="badge badge-primary">medium (B)</div>
                                {% elif todo.priority == "C" %}
                                    <div class="badge badge-secondary">low (C)</div>
                                {% else %}
                                    <div class="badge badge-info">very low ({{ todo.priority|capfirst }})</div>
                                {% endif %}
                            {% endif %}
                        </div>

                        <div class="col-span-2 justify-self-center self-center text-center">
                            {% if todo.projects.all.count == 0 %}
                                -
                            {% else %}
                                {% for project in todo.projects.all %}
                                    <div class="badge badge-primary">
                                        <span class="material-symbols-rounded mr-1 text-sm">assignment</span> 
                                        {{ project.name }}
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>

                        <div class="text-center">{{ todo.due_date|naturalday:"D d.m.y"|capfirst }}</div>

                        <div class="text-center">
                            <a class="hover:text-success" href="#"><span class="material-symbols-rounded">check</span></a>
                            <a class="hover:text-info" href="#"><span class="material-symbols-rounded">update</span></a>
                            <a class="hover:text-primary" href="#"><span class="material-symbols-rounded">edit</span></a>
                            <a class="hover:text-secondary" href="#"><span class="material-symbols-rounded">playlist_add</span></a>
                        </div>

                        {% comment %} <div class="col-span-12 ml-16 mt-2">
                            <div class="grid grid-cols-6 text-sm">
                                <div class="font-semibold flex">
                                    <span class="material-symbols-rounded mr-1 text-sm">arrow_forward_ios</span>
                                    DATE
                                </div>
                                <div class="col-span-5">TEXT TEXT TEXT</div>
                            </div>
                        </div> {% endcomment %}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
{% endblock %}